<?php if ( ! defined('BASEPATH')) exit('No direct script access allowed');

class Contact extends CI_Controller {
	
  public function __construct()
   {
		parent::__construct();
		// Your own constructor code
   }


	public function ask_the_staff()
		{
			$data['title'] = 'Ask the Staff';
			$data['header_view'] = 'headers/simple_view';
			$data['view'] = 'contact/ask_the_staff_view';
			$data['footer_view'] = 'footer_simple';
			$this->load->view('template', $data);
		}
		
	public function ask_the_staff_send()
		{
			$this->load->library('form_validation');
			$this->form_validation->set_rules('name', 'Name', 'required|alpha');
			$this->form_validation->set_rules('email', 'Email', 'required|valid_email');
			$this->form_validation->set_rules('phone', 'Phone', 'required|alpha_dash');
			$this->form_validation->set_rules('procedure', 'Procedure', 'required');
			$this->form_validation->set_rules('user_message', 'Question', 'required');
			
		
		
			if ($this->form_validation->run() == FALSE)
			{
				$this->ask_the_staff();
			}
			else // SEND THE MESSAGE
			{
				$this->load->library('email');
				$config['charset'] = 'iso-8859-1';
				$config['wordwrap'] = TRUE;
				$config['newline'] = '\r\n';

				$this->email->initialize($config);
				
				$this->email->from('askthestaff@indyface.com', 'Indyface Contact');
				$this->email->to('allenedwards48@gmail.com'); 
				
				$this->email->subject('Indyface Contact');

				$message = "Sender Contact information ----------------------- \r\n";
				$message .= "Name: ".$this->input->post('name')."\r\n";
				$message .= "Email: ".$this->input->post('email')."\r\n"; 
				$message .= "Phone: ".$this->input->post('phone')."\r\n";
				$message .= "Procedure: ".$this->input->post('procedure'); 
				
				$message .= "\r\n\r\n";
				
				$message .= " -------------------- User Message -------------------- \r\n\r\n";
				$message .=  $this->input->post('user_message'); 
				$message .= "\r\n\r\n -------------------- End of User Message --------------------";
				
				$this->email->message($message);	
				
				$this->email->send();
				
				redirect('/contact/thankyou', 'refresh');
			}

		}
		
		public function thankyou()
		{
			$data['title'] = 'Contact Thank You';
			$data['view'] = 'contact/thankyou_view';
			$data['footer_view'] = 'footer_simple';
			$this->load->view('template', $data);
		}
		

}

/* End of file welcome.php */
/* Location: ./application/controllers/welcome.php */